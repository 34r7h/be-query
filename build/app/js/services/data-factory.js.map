{"version":3,"sources":["services/data-factory.es6"],"names":[],"mappings":";;AAAA,AAAC,CAAA,YAAY;AACZ,aAAY,CAAC;;;;;;;;;AASb,QAAO,CACL,MAAM,CAAC,OAAO,CAAC,CACf,OAAO,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;;AAExB,UAAS,IAAI,CAAC,eAAe,EAAE,aAAa,EAAE,KAAK,EAAE;AACpD,MAAI,QAAQ,GAAG,EAAE,CAAC;AAClB,UAAQ,CAAC,EAAE,GAAG,IAAI,QAAQ,CAAC,kCAAkC,CAAC,CAAC;AAC/D,UAAQ,CAAC,EAAE,GAAG,eAAe,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;AAC3C,UAAQ,CAAC,IAAI,GAAG,aAAa,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;;AAE3C,MAAI,IAAI,GAAG,QAAQ,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC;AACpC,MAAI,IAAI,EAAE;AACT,UAAO,CAAC,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC;AACxC,QAAK,CAAC,IAAI,GAAG,IAAI,CAAC;AAClB,WAAQ,CAAC,EAAE,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,YAAK;AAC/B,KAAC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,EAAC,OAAO,EAAE,IAAI,CAAC,GAAG,EAAE,EAAC,EAAE,QAAQ,CAAC,EAAE,CAAC,KAAK,EAAE,CAAA,GAAI,IAAI,CAAC;AACrG,YAAQ,CAAC,OAAO,GAAG,EAAE,CAAC;AACtB,YAAQ,CAAC,MAAM,GAAG,EAAE,CAAC;AACrB,WAAO,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,OAAO,EAAE,UAAC,KAAK,EAAE,GAAG,EAAI;AAC7D,aAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;KAC1C,CAAC,CAAC;AACH,WAAO,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,UAAC,KAAK,EAAE,QAAQ,EAAI;AACjE,aAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,EAAE,CAAC;AAC/B,YAAO,CAAC,OAAO,CAAC,KAAK,EAAE,UAAC,KAAK,EAAE,QAAQ,EAAG;AACzC,aAAO,CAAC,GAAG,CAAC,QAAQ,EAAE,OAAO,KAAK,KAAK,QAAQ,CAAC,CAAC;AACjD,cAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;MACxD,CAAC,CAAA;KACF,CAAC,CAAC;IACH,CAAC,CAAC;GACH,MAAM;AACN,UAAO,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;GAC3B;AACD,SAAO,QAAQ,CAAC;EAChB;CACD,CAAA,EAAE,CAAE","file":"services/data-factory.js","sourcesContent":["(function () {\n\t'use strict';\n\n\t/**\n\t * @ngdoc service\n\t * @name query.factory:Data\n\t *\n\t * @description\n\t *\n\t */\n\tangular\n\t\t.module('query')\n\t\t.factory('Data', Data);\n\n\tfunction Data($firebaseObject, $firebaseAuth, State) {\n\t\tlet DataBase = {};\n\t\tDataBase.db = new Firebase('https://queryful.firebaseio.com/');\n\t\tDataBase.fb = $firebaseObject(DataBase.db);\n\t\tDataBase.auth = $firebaseAuth(DataBase.db);\n\n\t\tvar auth = DataBase.auth.$getAuth();\n\t\tif (auth) {\n\t\t\tconsole.info(\"Logged in as:\", auth.uid);\n\t\t\tState.user = auth;\n\t\t\tDataBase.fb.$loaded().then(()=> {\n\t\t\t\t!DataBase.fb[auth.uid] ? (DataBase.fb[auth.uid] = {created: Date.now()}, DataBase.fb.$save()) : null;\n\t\t\t\tDataBase.history = {};\n\t\t\t\tDataBase.sheets = {};\n\t\t\t\tangular.forEach(DataBase.fb[auth.uid].history, (entry, key)=> {\n\t\t\t\t\tDataBase.history[key] = JSON.parse(entry);\n\t\t\t\t});\n\t\t\t\tangular.forEach(DataBase.fb[auth.uid].sheets, (entry, entryKey)=> {\n\t\t\t\t\tDataBase.sheets[entryKey] = {};\n\t\t\t\t\tangular.forEach(entry, (sheet, sheetKey)=>{\n\t\t\t\t\t\tconsole.log(sheetKey, typeof sheet === 'string');\n\t\t\t\t\t\tDataBase.sheets[entryKey][sheetKey] = JSON.parse(sheet);\n\t\t\t\t\t})\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\tconsole.info(\"Logged out\");\n\t\t}\n\t\treturn DataBase;\n\t}\n}());\n"],"sourceRoot":"/source/"}